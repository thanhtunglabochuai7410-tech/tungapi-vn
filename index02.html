<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>PlayGame APK</title>
  <style>
    :root{font-family:Inter, Roboto, Arial, sans-serif;color:#111}
    body{margin:0;padding:32px;background:#f6f7fb;display:flex;align-items:center;justify-content:center;min-height:100vh}
    .card{width:100%;max-width:760px;background:#fff;border-radius:12px;box-shadow:0 6px 24px rgba(20,20,50,.08);padding:28px}
    h1{margin:0 0 10px;font-size:20px}
    p.lead{margin:0 0 18px;color:#444}
    .row{display:flex;gap:12px;flex-wrap:wrap}
    label{display:block;font-size:13px;color:#666;margin-bottom:6px}
    input[type="text"], input[type="url"]{width:100%;padding:10px;border:1px solid #e4e6ef;border-radius:8px}
    .controls{display:flex;gap:10px;margin-top:12px}
    button{padding:10px 14px;border-radius:10px;border:0;background:#0b84ff;color:#fff;font-weight:600;cursor:pointer}
    button.secondary{background:#eee;color:#222}
    .info{margin-top:18px;font-size:13px;color:#444}
    .note{background:#fff9e6;padding:10px;border-radius:8px;border:1px solid #f1e3c6;margin-top:14px}
    .steps{margin-top:14px}
    .hashBox{margin-top:10px;font-family:monospace;background:#f4f6fb;padding:10px;border-radius:8px}
    footer{margin-top:18px;font-size:12px;color:#888}
  </style>
</head>
<body>
  <div class="card">
    <h1>Dowload APK</h1>
    <p class="lead">M·∫´u trang HTML ƒë·ªÉ cho ph√©p ng∆∞·ªùi d√πng t·∫£i file APK. Thay <code>APK_URL</code> b·∫±ng ƒë∆∞·ªùng d·∫´n file th·ª±c t·∫ø c·ªßa b·∫°n.</p>

    <div>
      <label for="apkUrl">URL file APK</label>
      <input id="apkUrl" type="url" placeholder="https://www.mediafire.com/file/mu7l0hkafnnqbs6/PlayMod.apk/file" value="https://www.mediafire.com/file/mu7l0hkafnnqbs6/PlayMod.apk/file">
    </div>
  <div class="controls">
      <button id="setBtn">S·ª≠ d·ª•ng URL n√†y</button>
      <button id="downloadBtn" disabled>‚Üì T·∫£i file APK</button>
      <button id="hashBtn" class="secondary" title="T√≠nh SHA-256 (y√™u c·∫ßu CORS)">üîí T√≠nh SHA-256</button>
    </div>

    <div class="info">
      <div>Tr·∫°ng th√°i: <span id="status">Ch∆∞a s·∫µn s√†ng</span></div>
      <div class="hashBox" id="hashBox" style="display:none">SHA-256: <span id="hashVal">‚Äî</span></div>
    </div>

    <div class="note">
      <strong>L∆∞u √Ω v·∫≠n h√†nh:</strong>
      <ul>
        <li>File APK ph·∫£i ƒë∆∞·ª£c host tr√™n server v·ªõi header <code>Content-Type: application/vnd.android.package-archive</code>.</li>
        <li>N·∫øu b·∫°n mu·ªën t√≠nh to√°n checksum ho·∫∑c fetch file b·∫±ng JavaScript, server ph·∫£i cho ph√©p <code>Access-Control-Allow-Origin: *</code> (ho·∫∑c domain c·ªßa b·∫°n).</li>
        <li>Tr√¨nh duy·ªát Android th∆∞·ªùng m·ªü tr·ª±c ti·∫øp link t·∫£i (ng∆∞·ªùi d√πng c·∫ßn b·∫≠t <em>Unknown Sources</em> ƒë·ªÉ c√†i file ngo√†i Play Store).</li>
      </ul>
    </div>

    <div class="steps">
      <strong>H∆∞·ªõng d·∫´n c√†i ƒë·∫∑t (ng∆∞·ªùi d√πng Android):</strong>
      <ol>
        <li>T·∫£i file APK b·∫±ng n√∫t ‚ÄúT·∫£i file APK‚Äù.</li>
        <li>M·ªü file ƒë√£ t·∫£i trong tr√¨nh qu·∫£n l√Ω file ho·∫∑c thanh th√¥ng b√°o.</li>
        <li>N·∫øu c·∫ßn, cho ph√©p c√†i ·ª©ng d·ª•ng t·ª´ ngu·ªìn kh√¥ng x√°c ƒë·ªãnh trong c√†i ƒë·∫∑t.</li>
        <li>Nh·∫•n "C√†i ƒë·∫∑t" v√† ch·ªù ho√†n t·∫•t.</li>
      </ol>
    </div>

    <footer>
      Mu·ªën thay ƒë·ªïi giao di·ªán ho·∫∑c th√™m tracking? M√¨nh c√≥ th·ªÉ h·ªó tr·ª£ ti·∫øp.
    </footer>
  </div>

  <script>
    // C√°c th√†nh ph·∫ßn DOM
    const apkUrlInput = document.getElementById('apkUrl');
    const setBtn = document.getElementById('setBtn');
    const downloadBtn = document.getElementById('downloadBtn');
    const statusEl = document.getElementById('status');
    const hashBtn = document.getElementById('hashBtn');
    const hashBox = document.getElementById('hashBox');
    const hashVal = document.getElementById('hashVal');

    let currentUrl = apkUrlInput.value.trim();

    function updateStatus(text){ statusEl.textContent = text; }

    // G√°n URL m·ªõi
    setBtn.addEventListener('click', () => {
      const url = apkUrlInput.value.trim();
      if(!url){ alert('Vui l√≤ng nh·∫≠p URL h·ª£p l·ªá'); return; }
      currentUrl = url;
      prepareDownloadLink(currentUrl);
      updateStatus('URL ƒë√£ ƒë·∫∑t: ' + currentUrl);
    });

    // T·∫°o v√† k√≠ch ho·∫°t link download
    function prepareDownloadLink(url){
      downloadBtn.disabled = false;
      // T·∫°o anchor ·∫©n ‚Äî d√πng thu·ªôc t√≠nh download ƒë·ªÉ c·ªë g·∫Øng l∆∞u file v·ªõi t√™n g·ª£i √Ω
      downloadBtn.onclick = () => {
        const a = document.createElement('a');
        a.href = url;
        // g·ª£i √Ω t√™n file ‚Äî n·∫øu server tr·∫£ header Content-Disposition th√¨ s·∫Ω ∆∞u ti√™n
        const suggestedName = url.split('/').pop() || 'app.apk';
        a.setAttribute('download', suggestedName);
        // m·ªü trong tab m·ªõi n·∫øu server kh√¥ng cho ph√©p direct download
        a.target = '_blank';
        document.body.appendChild(a);
        a.click();
        a.remove();
        updateStatus('B·∫Øt ƒë·∫ßu t·∫£i xu·ªëng ‚Äî n·∫øu kh√¥ng x·∫£y ra, ki·ªÉm tra ƒë∆∞·ªùng d·∫´n v√† CORS/server headers.');
      }
    }

    // T·ª± kh·ªüi t·∫°o l·∫ßn ƒë·∫ßu
    prepareDownloadLink(currentUrl);
    updateStatus('S·∫µn s√†ng ‚Äî ki·ªÉm tra URL v√† nh·∫•n "T·∫£i file APK"');

    // T√≠nh SHA-256 (n·∫øu server cho ph√©p CORS)
    async function computeSHA256(url){
      try{
        updateStatus('ƒêang fetch file ƒë·ªÉ t√≠nh hash (c·∫ßn CORS) ...');
        const res = await fetch(url);
        if(!res.ok) throw new Error('Fetch failed: ' + res.status);
        const buf = await res.arrayBuffer();
        const hashBuf = await crypto.subtle.digest('SHA-256', buf);
        const hashArray = Array.from(new Uint8Array(hashBuf));
        const hashHex = hashArray.map(b => b.toString(16).padStart(2,'0')).join('');
        return hashHex;
      }catch(e){
        throw e;
      }
    }

    hashBtn.addEventListener('click', async () => {
      hashBox.style.display = 'none';
      hashVal.textContent = '‚Äî';
      try{
        hashBtn.disabled = true;
        const hash = await computeSHA256(currentUrl);
        hashVal.textContent = hash;
        hashBox.style.display = 'block';
        updateStatus('ƒê√£ t√≠nh SHA-256. So s√°nh v·ªõi gi√° tr·ªã tr√™n server ƒë·ªÉ ƒë·∫£m b·∫£o file kh√¥ng b·ªã thay ƒë·ªïi.');
      }catch(err){
        console.error(err);
        updateStatus('Kh√¥ng th·ªÉ fetch/t√≠nh hash ‚Äî r·∫•t c√≥ th·ªÉ do CORS ho·∫∑c URL kh√¥ng h·ª£p l·ªá.');
        alert('L·ªói khi fetch ho·∫∑c t√≠nh hash: ' + (err.message || err));
      }finally{
        hashBtn.disabled = false;
      }
    });

    // T√πy ch·ªçn: ph√°t hi·ªán thi·∫øt b·ªã
    function isAndroid(){ return /Android/i.test(navigator.userAgent); }
    if(!isAndroid()){
      const note = document.createElement('div');
      note.style.marginTop = '12px';
      note.style.fontSize = '13px';
      note.style.color = '#555';
      note.textContent = 'B·∫°n ƒëang kh√¥ng ·ªü tr√™n Android ‚Äî ng∆∞·ªùi d√πng Android s·∫Ω c·∫ßn t·∫£i v√† c√†i ƒë·∫∑t file APK tr√™n thi·∫øt b·ªã c·ªßa h·ªç.';
      document.querySelector('.card').appendChild(note);
    }
  </script>
</body>
</html>
